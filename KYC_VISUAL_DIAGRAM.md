# ğŸ“Š KYC ALERT SYSTEM - VISUAL DIAGRAM

## ğŸ”„ Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      WARGA LOGIN                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Check KYC Status (StreamBuilder)                   â”‚
â”‚              Query: kyc_documents where userId                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                  â–¼                â–¼                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ No KYC  â”‚      â”‚ Pending  â”‚    â”‚ Approved â”‚    â”‚ Rejected â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚                 â”‚               â”‚               â”‚
              â–¼                 â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Show Alert:  â”‚  â”‚ Show Alert:  â”‚  â”‚ No Alert â”‚  â”‚ Show Alert:  â”‚
    â”‚ "Lengkapi    â”‚  â”‚ "Menunggu    â”‚  â”‚          â”‚  â”‚ "KYC Ditolak"â”‚
    â”‚  Data KYC"   â”‚  â”‚  Verifikasi" â”‚  â”‚          â”‚  â”‚              â”‚
    â”‚              â”‚  â”‚              â”‚  â”‚          â”‚  â”‚              â”‚
    â”‚ [Upload] â”€â”€â–º â”‚  â”‚ (No button)  â”‚  â”‚          â”‚  â”‚ [Upload] â”€â”€â–º â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚               â”‚               â”‚
         â–¼                  â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Scan:ğŸ”’  â”‚       â”‚ Scan:ğŸ”’  â”‚   â”‚ Scan:âœ…  â”‚   â”‚ Scan:ğŸ”’  â”‚
    â”‚ Disabled â”‚       â”‚ Disabled â”‚   â”‚ Active   â”‚   â”‚ Disabled â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Menu Access Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Feature    â”‚ No KYC  â”‚ Pending  â”‚ Approved â”‚ Rejected â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Home         â”‚   âœ…    â”‚    âœ…    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Pengumuman   â”‚   âœ…    â”‚    âœ…    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Pengaduan    â”‚   âœ…    â”‚    âœ…    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Akun         â”‚   âœ…    â”‚    âœ…    â”‚    âœ…    â”‚    âœ…    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Scan Button  â”‚   ğŸ”’    â”‚    ğŸ”’    â”‚    âœ…    â”‚    ğŸ”’    â”‚
â”‚ Marketplace  â”‚   ğŸ”’    â”‚    ğŸ”’    â”‚    âœ…    â”‚    ğŸ”’    â”‚
â”‚ Iuran        â”‚   ğŸ”’    â”‚    ğŸ”’    â”‚    âœ…    â”‚    ğŸ”’    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
âœ… = Accessible
ğŸ”’ = Locked (Show KYC Required Dialog)
```

---

## ğŸ“± UI Component Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WargaMainPage                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚         KYC Alert Banner (StreamBuilder)            â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ âš ï¸  Lengkapi Data KYC Anda                      â”‚ â”‚ â”‚
â”‚ â”‚ â”‚     Upload KTP & KK untuk mengakses semua fitur â”‚ â”‚ â”‚
â”‚ â”‚ â”‚                               [Upload] â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚              IndexedStack (Current Page)                 â”‚
â”‚                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚          Page Content                      â”‚        â”‚
â”‚   â”‚    (Home/Pengumuman/Pengaduan/Akun)       â”‚        â”‚
â”‚   â”‚                                            â”‚        â”‚
â”‚   â”‚                                            â”‚        â”‚
â”‚   â”‚                                            â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Bottom Navigation Bar                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ â”‚Home â”‚Pengumum.â”‚ SCAN â”‚Pengaduanâ”‚ Akun â”‚              â”‚
â”‚ â”‚ ğŸ   â”‚   ğŸ“¢    â”‚  ğŸ“·  â”‚   ğŸ“    â”‚  ğŸ‘¤  â”‚              â”‚
â”‚ â”‚     â”‚         â”‚  ğŸ”’  â”‚         â”‚      â”‚              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Real-time Update Flow

```
Firebase Firestore
      â”‚
      â”‚ Stream
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  StreamBuilder  â”‚
â”‚  (KYC Status)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Data Changes
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Update UI Components  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Alert Banner          â”‚
â”‚ â€¢ Scan Button State     â”‚
â”‚ â€¢ Menu Restrictions     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Auto Rebuild
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User Sees Update     â”‚
â”‚  (No Refresh Needed)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Example:**
```
Admin Approve KYC in Console
          â†“
Firebase Update Document
          â†“
Stream Detects Change (< 1 second)
          â†“
StreamBuilder Rebuilds Widget
          â†“
Alert Banner Disappears
Scan Button Becomes Active
          â†“
User Sees Changes Immediately
```

---

## ğŸ¨ Scan Button Visual States

### State 1: Not Verified (ğŸ”’)
```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              â”‚
    â”‚      ğŸ“·      â”‚  â† Gray Gradient
    â”‚              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”      â”‚
    â”‚  â”‚ ğŸ”’ â”‚      â”‚  â† Lock Badge
    â”‚  â””â”€â”€â”€â”€â”˜      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    [Click]
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KYC Required Dialog   â”‚
â”‚                        â”‚
â”‚  Documents needed:     â”‚
â”‚  â€¢ KTP                 â”‚
â”‚  â€¢ KK                  â”‚
â”‚                        â”‚
â”‚  [Nanti] [Upload] â”€â”€â”€â”€â–ºâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### State 2: Verified (âœ…)
```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              â”‚
    â”‚      ğŸ“·      â”‚  â† Blue Gradient
    â”‚              â”‚  â† Active, No Lock
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    [Click]
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Scan Feature        â”‚
â”‚   (Implementation)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” KYC Verification Logic

```
getUserKYCDocuments(userId)
        â†“
   Query Result
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Filter Documents:     â”‚
â”‚ â€¢ KTP Document        â”‚
â”‚ â€¢ KK Document         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                     â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Both Found?  â”‚    â”‚ KTP Status?  â”‚    â”‚ KK Status?   â”‚
â”‚   Yes/No     â”‚    â”‚   approved   â”‚    â”‚   approved   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  All Approved?  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                 â”‚
                  â–¼                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   TRUE   â”‚      â”‚  FALSE   â”‚
            â”‚          â”‚      â”‚          â”‚
            â”‚ isKYC    â”‚      â”‚ isKYC    â”‚
            â”‚ Verified â”‚      â”‚ Verified â”‚
            â”‚ = true   â”‚      â”‚ = false  â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                 â”‚                 â”‚
                 â–¼                 â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Enable    â”‚      â”‚ Disable   â”‚
          â”‚ Scan      â”‚      â”‚ Scan      â”‚
          â”‚ Button    â”‚      â”‚ Button    â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Component Hierarchy

```
WargaMainPage (StatefulWidget)
â”‚
â”œâ”€â”€ initState()
â”‚   â””â”€â”€ Initialize _allPages list
â”‚
â”œâ”€â”€ build(BuildContext)
â”‚   â”‚
â”‚   â”œâ”€â”€ Get AuthProvider (userId)
â”‚   â”‚
â”‚   â””â”€â”€ Scaffold
â”‚       â”‚
â”‚       â”œâ”€â”€ body: Column
â”‚       â”‚   â”‚
â”‚       â”‚   â”œâ”€â”€ if (userId != null)
â”‚       â”‚   â”‚   â””â”€â”€ _buildKYCAlertBanner(userId)
â”‚       â”‚   â”‚       â””â”€â”€ StreamBuilder<QuerySnapshot>
â”‚       â”‚   â”‚           â”œâ”€â”€ stream: getUserKYCDocuments()
â”‚       â”‚   â”‚           â””â”€â”€ builder: Alert Widget
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ Expanded
â”‚       â”‚       â””â”€â”€ IndexedStack
â”‚       â”‚           â”œâ”€â”€ index: _getPageIndex(_currentIndex)
â”‚       â”‚           â””â”€â”€ children: _allPages
â”‚       â”‚
â”‚       â””â”€â”€ bottomNavigationBar
â”‚           â””â”€â”€ StreamBuilder<QuerySnapshot>
â”‚               â”œâ”€â”€ stream: getUserKYCDocuments()
â”‚               â””â”€â”€ builder: _buildBottomNav(isKYCVerified)
â”‚                   â”‚
â”‚                   â”œâ”€â”€ Stack
â”‚                   â”‚   â”œâ”€â”€ CustomPaint (BottomNavPainter)
â”‚                   â”‚   â”‚   â””â”€â”€ Row (Nav Items)
â”‚                   â”‚   â”‚       â”œâ”€â”€ Home
â”‚                   â”‚   â”‚       â”œâ”€â”€ Pengumuman
â”‚                   â”‚   â”‚       â”œâ”€â”€ Spacer (for Scan)
â”‚                   â”‚   â”‚       â”œâ”€â”€ Pengaduan
â”‚                   â”‚   â”‚       â””â”€â”€ Akun
â”‚                   â”‚   â”‚
â”‚                   â”‚   â””â”€â”€ Positioned (Scan Button)
â”‚                   â”‚       â””â”€â”€ _buildScanButton(isKYCVerified)
â”‚                   â”‚
â”‚                   â””â”€â”€ Methods:
â”‚                       â”œâ”€â”€ _buildNavItem()
â”‚                       â”œâ”€â”€ _showKYCRequiredDialog()
â”‚                       â””â”€â”€ _buildRequirementItem()
```

---

## ğŸ¯ User Journey Flow

### Journey 1: New User â†’ Verified
```
1. Register & Login
   â†“
2. See Dashboard with Alert
   "Lengkapi Data KYC Anda"
   â†“
3. Click [Upload] Button
   â†“
4. KYC Upload Wizard
   â€¢ Upload KTP
   â€¢ Upload KK
   â€¢ Face Verification
   â€¢ Complete Data
   â†“
5. Submit KYC
   â†“
6. Alert Changes to
   "Menunggu Verifikasi KYC"
   â†“
7. Admin Reviews & Approves
   â†“
8. Alert Disappears Automatically
   Scan Button Becomes Active
   â†“
9. Full Access to All Features
```

### Journey 2: Click Scan (Not Verified)
```
1. User Clicks Scan Button
   â†“
2. Check: isKYCVerified?
   â†“ (false)
3. Show Dialog:
   "KYC Diperlukan"
   â†“
4. User Options:
   â”œâ”€ [Nanti] â†’ Close Dialog
   â””â”€ [Upload Sekarang] â†’ Go to KYC Wizard
```

---

## ğŸ” Security & Access Control

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Feature Access Control             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                           â”‚
â”‚  Public (No KYC Required):                â”‚
â”‚  â”œâ”€ Home Dashboard                        â”‚
â”‚  â”œâ”€ Pengumuman (Announcements)           â”‚
â”‚  â”œâ”€ Pengaduan (Complaints)               â”‚
â”‚  â””â”€ Akun (Account Settings)              â”‚
â”‚                                           â”‚
â”‚  Protected (KYC Required):                â”‚
â”‚  â”œâ”€ QR Scanner                            â”‚
â”‚  â”œâ”€ Marketplace (Future)                  â”‚
â”‚  â”œâ”€ Iuran Payment (Future)               â”‚
â”‚  â””â”€ Advanced Features (Future)            â”‚
â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Performance Considerations

### StreamBuilder Optimization
```
âœ… Single Stream per Component
âœ… Proper Stream Disposal
âœ… Efficient Query (userId filter)
âœ… Minimal Rebuilds
âœ… Cache-friendly
```

### Real-time Updates
```
Firebase â†’ Stream â†’ Widget
   â†“         â†“        â†“
  Fast    Efficient  Smooth
(<1sec)  (Minimal)  (No lag)
```

---

## ğŸ‰ Complete Implementation Checklist

```
UI Components:
â”œâ”€ [âœ“] KYC Alert Banner
â”œâ”€ [âœ“] Alert message variants (No KYC/Pending/Rejected)
â”œâ”€ [âœ“] Upload button in alert
â”œâ”€ [âœ“] Scan button with states
â”œâ”€ [âœ“] Lock badge for disabled state
â”œâ”€ [âœ“] KYC Required Dialog
â”œâ”€ [âœ“] Dialog content & buttons
â”œâ”€ [âœ“] Bottom navigation (5 menus)
â””â”€ [âœ“] Page placeholders (Pengumuman, Pengaduan)

Logic & Functionality:
â”œâ”€ [âœ“] StreamBuilder for real-time
â”œâ”€ [âœ“] KYC status checking
â”œâ”€ [âœ“] Document verification logic
â”œâ”€ [âœ“] Menu restriction logic
â”œâ”€ [âœ“] Navigation handling
â”œâ”€ [âœ“] Dialog show/hide logic
â””â”€ [âœ“] State management

Integration:
â”œâ”€ [âœ“] Firebase Firestore connection
â”œâ”€ [âœ“] KYC Service integration
â”œâ”€ [âœ“] Auth Provider integration
â””â”€ [âœ“] Navigation routing

Testing:
â”œâ”€ [âœ“] No compilation errors
â”œâ”€ [âœ“] No runtime errors
â”œâ”€ [âœ“] Test scripts ready
â””â”€ [âœ“] Documentation complete
```

---

**ğŸ“Š Visual diagrams complete! Ready for implementation testing! ğŸš€**

